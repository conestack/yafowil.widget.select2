var yafowil_select2=function(t,i){"use strict";class e{static initialize(t){i(".select2",t).each((function(t){let n=i(this);if(n.parents(".arraytemplate").length)return;let a=n.data();new e(n,a)}))}constructor(t,i){this.elem=t,this.options=this.init_options(i);try{this.elem.select2(this.options)}catch(t){throw`Failed to initialize select2: ${t}`}t.data("yafowil-select2",this)}init_options(t){for(let i in t)t[i]=this.extract_value(t[i]);return t.ajaxurl&&(t.ajax={url:t.ajaxurl,dataType:"json",data:function(t,i){return{q:t}},results:function(i,e,n){return t.tags&&!i.length&&i.push({id:n.term,text:n.term}),{results:i}}},t.initSelection=function(e,n){let a=e.val();if(!a)return;let r=e.data("vocabulary");function o(t){return r&&r[t]?r[t]:t}if(t.multiple){let t=[];i(e.val().split(",")).each((function(){t.push({id:this,text:o(this)})})),n(t)}else n({id:a,text:o(a)})}),t}extract_value(t){if("string"==typeof t&&!t.indexOf("javascript:")){if(!(t=t.substring(11,t.length).split("."))[0].length)throw"No function defined";let i=window;for(let e of t){if(void 0===i[e])throw`${e} not found`;i=i[e]}t=i}return t}}function n(t,i){e.initialize(i)}function a(){void 0!==window.yafowil_array&&window.yafowil_array.on_array_event("on_add",n)}return i((function(){void 0!==window.ts?ts.ajax.register(e.initialize,!0):void 0!==window.bdajax?bdajax.register(e.initialize,!0):e.initialize(),a()})),t.Select2Widget=e,t.register_array_subscribers=a,Object.defineProperty(t,"__esModule",{value:!0}),window.yafowil=window.yafowil||{},window.yafowil.select2=t,t}({},jQuery);
