var yafowil_select2=function(t,e){"use strict";class i{static initialize(t){e(".select2",t).each((function(t){let n=e(this),a=n.data();new i(n,a)}))}constructor(t,e){this.elem=t,this.options=this.init_options(e);try{this.elem.select2(this.options)}catch(t){throw`Failed to initialize select2: ${t}`}t.data("yafowil-select2",this)}init_options(t){for(let e in t)t[e]=this.extract_value(t[e]);return t.ajaxurl&&(t.ajax={url:t.ajaxurl,dataType:"json",data:function(t,e){return{q:t}},results:function(e,i,n){return t.tags&&!e.length&&e.push({id:n.term,text:n.term}),{results:e}}},t.initSelection=function(i,n){let a=i.val();if(!a)return;let o=i.data("vocabulary");function r(t){return o&&o[t]?o[t]:t}if(t.multiple){let t=[];e(i.val().split(",")).each((function(){t.push({id:this,text:r(this)})})),n(t)}else n({id:a,text:r(a)})}),t}extract_value(t){if("string"==typeof t&&!t.indexOf("javascript:")){if(!(t=t.substring(11,t.length).split("."))[0].length)throw"No function defined";let e=window;for(let i of t){if(void 0===e[i])throw`${i} not found`;e=e[i]}t=e}return t}}function n(t,e){i.initialize(e)}function a(t,i,n){e(".select2",i).each((function(){let a=e(this),o=a.data("reference-name"),r=t.base_id(i).replace(/\-/g,".");a.data("reference-name",t.set_value_index(o,r,n,"."))}))}return e((function(){void 0!==yafowil_array&&(yafowil_array.on_array_event("on_add",n),yafowil_array.on_array_event("on_index",a))})),e((function(){void 0!==window.ts?ts.ajax.register(i.initialize,!0):void 0!==window.bdajax?bdajax.register(i.initialize,!0):i.initialize()})),t.Select2Widget=i,Object.defineProperty(t,"__esModule",{value:!0}),window.yafowil=window.yafowil||{},window.yafowil.select2=t,t}({},jQuery);
