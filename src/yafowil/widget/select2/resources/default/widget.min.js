var yafowil_select2=function(t,e){"use strict";e.fn.select2.amd.define("select2/data/singleValueAjaxAdapter",["select2/data/ajax","select2/utils"],function(t,e){function i(t,e){i.__super__.constructor.call(this,t,e)}return e.Extend(i,t),i.prototype.current=function(t){let e=this.$element.val(),i=this.$element.data("vocabulary");var a;t([{id:e,text:(a=e,i&&i[a]?i[a]:a)}])},i.prototype.select=function(e){this.$element.find('option[value="'+e.id+'"]').prop("selected",!0),t.prototype.select.call(this,e)},i}),e.fn.select2.amd.define("select2/data/multiValueAjaxAdapter",["select2/data/ajax","select2/utils"],function(t,e){function i(t,e){i.__super__.constructor.call(this,t,e)}return e.Extend(i,t),i.prototype.current=function(t){let e=this.$element.val(),i=this.$element.data("vocabulary");let a=[];e.split(",").forEach(t=>{var e;a.push({id:t,text:(e=t,i&&i[e]?i[e]:e)})}),t(a)},i.prototype.select=function(e){t.prototype.select.call(this,e)},i});const i=e.fn.select2.amd.require("select2/data/singleValueAjaxAdapter"),a=e.fn.select2.amd.require("select2/data/multiValueAjaxAdapter");class n{static initialize(t){e(".select2",t).each(function(t){let i=e(this);if(void 0!==window.yafowil_array&&window.yafowil_array.inside_template(i))return;let a=i.data();new n(i,a)})}constructor(t,e){this.elem=t,this.options=this.init_options(e);try{this.elem.select2(this.options)}catch(t){throw`Failed to initialize select2: ${t}`}t.data("yafowil-select2",this)}init_options(t){for(let e in t)t[e]=this.extract_value(t[e]);return t.ajaxurl&&(t.ajax={url:t.ajaxurl,dataType:"json",data:function(t){return{q:t.term}},processResults:function(e,i){return t.tags&&!e.length&&e.push({id:i.term,text:i.term}),{results:e.map(t=>({id:t.id,text:t.text||t.id}))}}},t.multiple?t.dataAdapter=a:t.dataAdapter=i),t.selectionCssClass="select2--medium",t.dropdownCssClass="select2--medium",t.width="500px",t}extract_value(t){if("string"==typeof t&&!t.indexOf("javascript:")){if(!(t=t.substring(11,t.length).split("."))[0].length)throw"No function defined";let e=window;for(let i of t){if(void 0===e[i])throw`${i} not found`;e=e[i]}t=e}return t}}function l(t,e){n.initialize(e)}function s(){void 0!==window.yafowil_array&&window.yafowil_array.on_array_event("on_add",l)}return e(function(){void 0!==window.ts?ts.ajax.register(n.initialize,!0):void 0!==window.bdajax?bdajax.register(n.initialize,!0):n.initialize(),s()}),t.Select2Widget=n,t.register_array_subscribers=s,Object.defineProperty(t,"__esModule",{value:!0}),window.yafowil=window.yafowil||{},window.yafowil.select2=t,t}({},jQuery);
